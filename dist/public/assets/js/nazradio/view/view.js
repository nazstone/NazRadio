define(["jquery","marionette","nazradio/model","nazradio/util"],function(a,b,c,d){PlaylistRow=b.ItemView.extend({tagname:"div",className:"playlist-row list-group-item",template:"#playlist-row-template",triggers:{"click #control-trash":"item:trash","click #control-play":"item:play"}}),PlaylistView=b.CompositeView.extend({itemView:PlaylistRow,itemViewContainer:"#playlist-container",itemViewEventPrefix:"playlistEvent",template:"#playlist-template",displayInfo:function(a){var b=new c.Morceaux;if(null!=a.playlist&&a.playlist.length>0&&"object"==typeof a.playlist[0])for(var e=a.playlist.length,f=0;e>f;f++){var g=new c.Morceau({name:null!=a.playlist[f].name&&a.playlist[f].name.length>0?a.playlist[f].name:a.playlist[f].title,pos:parseInt(a.playlist[f].pos),artist:a.playlist[f].artist,album:a.playlist[f].album,time:d.UtilTime.timeToStr(a.playlist[f].time),play:a.status.song==f});b.add(g)}this.collection=b,this.render()},events:{"click #control-trash":"emptyPlaylist"},clickOnRowDelete:function(a){window.controllerPlaylist.sendRemoveFromPlaylist(a.model.get("pos"))},clickOnRowPlay:function(a){window.controllerPlaylist.sendPlayFromPlaylist(a.model.get("pos"))},emptyPlaylist:function(){window.controllerPlaylist.sendClearPlaylist()},initialize:function(){this.on("playlistEvent:item:trash",this.clickOnRowDelete),this.on("playlistEvent:item:play",this.clickOnRowPlay)}}),BrowseRow=b.ItemView.extend({tagname:"div",className:"list-group-item browse-row",template:"#browse-row-template",triggers:{"click #item":"click:item","click #control-play":"click:item:play","click #control-add":"click:item:add"}}),BrowseView=b.CompositeView.extend({itemView:BrowseRow,itemViewContainer:"#browse-container",itemViewEventPrefix:"browserItem",template:"#browse-template",triggers:{"click #reloadRoot":"browse:reloadRoot","click #reloadArtist":"browse:reloadArtist"},reloadRoot:function(){window.controllerBrowser.sendListArtist()},reloadArtist:function(){window.controllerBrowser.sendListArtistAlbum(this.model.get("artist"))},displayInfo:function(a){for(var b=new c.Morceaux,d=a.browser.length,e=0;d>e;e++){var f=a.browser[e].artist;null!=a.artist&&a.artist.length>0&&null!=a.album&&a.album.length>0?(f=a.browser[e].title,this.model.set({artist:a.artist,album:a.album})):null!=a.artist&&a.artist.length>0?(f=a.browser[e].album,this.model.set({artist:a.artist,album:""})):this.model.set({artist:"",album:""});var g=new c.Morceau({name:f});b.add(g)}this.collection=b,this.render()},clickOnRow:function(a){(null==this.model.get("album")||this.model.get("album").length<=0)&&(null!=this.model.get("artist")&&this.model.get("artist").length>0?window.controllerBrowser.sendListArtistAlbumMorceaux(this.model.get("artist"),a.model.get("name")):window.controllerBrowser.sendListArtistAlbum(a.model.get("name")))},extractInfo:function(a){var b="",c="",d="";return null!=this.model.get("artist")&&this.model.get("artist").length>0?(b=this.model.get("artist"),null!=this.model.get("album")&&this.model.get("album").length>0?(c=this.model.get("album"),d=a.model.get("name")):c=a.model.get("name")):b=a.model.get("name"),{artist:b,album:c,title:d}},clickOnRowAdd:function(a){var b=this.extractInfo(a);window.controllerPlaylist.sendAdd(b.artist,b.album,b.title),window.notif(message_file_add_playlist,!1)},clickOnRowPlay:function(a){var b=this.extractInfo(a);window.controllerPlaylist.sendPlay(b.artist,b.album,b.title),window.notif(message_file_add_playlist,!1)},initialize:function(){this.model=new c.BrowserItem({artist:"",album:""}),this.on("browserItem:click:item",this.clickOnRow),this.on("browserItem:click:item:add",this.clickOnRowAdd),this.on("browserItem:click:item:play",this.clickOnRowPlay),this.on("browse:reloadRoot",this.reloadRoot),this.on("browse:reloadArtist",this.reloadArtist)}});var e=b.CompositeView.extend({itemViewContainer:"#settings-container",template:"#settings-template",events:{"click #update":"update","click #shutdown":"shutdown"},shutdown:function(){window.controllerSettings.sendShutdown()},update:function(){window.controllerSettings.sendUpdate()},displayInfo:function(a){"update"==a.settings?window.notif(message_update_progress,!1):window.notif(message_stop,!0)}});RadioRow=b.ItemView.extend({tagname:"div",className:"list-group-item browse-row",template:"#radio-row-template",triggers:{"click #control-play":"click:item:play","click #control-remove":"click:item:remove"}});var f=b.CompositeView.extend({itemViewContainer:"#radio-container",template:"#radio-template",itemViewEventPrefix:"radioItem",itemView:RadioRow,displayInfo:function(a){var b=new c.Radios;if(null!=a.radios&&a.radios.length>0&&"object"==typeof a.radios[0])for(var d=a.radios.length,e=0;d>e;e++){var f=new c.Radio({url:a.radios[e].url,id:a.radios[e].id,title:a.radios[e].title});b.add(f)}this.collection=b,this.render()},initialize:function(){this.on("radioItem:click:item:play",this.clickOnRowPlay),this.on("radioItem:click:item:remove",this.clickOnRowRemove)},onDomRefresh:function(){a("#radio-add #title").focusin(function(){a("#radio-add #title").css("background-color","")}),a("#radio-add #url").focusin(function(){a("#radio-add #url").css("background-color","")})},clickOnRowPlay:function(a){window.controllerRadio.sendPlayRadio(a.model.get("id")),console.log("play "+a.model.get("id"))},clickOnRowRemove:function(a){window.controllerRadio.sendRemoveRadio(a.model.get("id")),console.log("remove "+a.model.get("id"))},clickOnInsertRadio:function(){var b="#radio-add #title",c="#radio-add #url",d="background-color";""!=a(b).val()&&""!=a(c).val()?(a(b).css(d,""),a(c).css(d,""),window.controllerRadio.sendInsertRadio(a(b).val(),a(c).val())):(window.notif(messageEmptyField,!1),a(b).css(d,"#f00"),a(c).css(d,"#f00"))},clickOnShowHideInsertRadio:function(){a("#radio-add").is(":visible")?a("#radio-add").hide():a("#radio-add").show()},events:{"click #control-add":"clickOnInsertRadio","click #control-plus":"clickOnShowHideInsertRadio"}});return{BrowseView:BrowseView,PlaylistView:PlaylistView,SettingsView:e,RadioView:f}});