define(["jquery","marionette","tpl!nazradio/view/playerView.tpl","nazradio/model","underscore","nazradio/util"],function(a,b,c,d,e,f){var g=0;return b.CompositeView.extend({el:a("#control-player"),template:c,events:{"click #control-backward":"prevClick","click #control-forward":"nextClick","click #control-stop":"stopClick","click #control-play":"playClick"},prevClick:function(){window.controllerPlayer.sendPrev()},stopClick:function(){window.controllerPlayer.sendStop()},nextClick:function(){window.controllerPlayer.sendNext()},playClick:function(){a("#control-play span").hasClass("glyphicon-play")?(a("#control-play span").removeClass("glyphicon-play"),a("#control-play span").addClass("glyphicon-pause"),window.controllerPlayer.sendPlay()):(a("#control-play span").removeClass("glyphicon-pause"),a("#control-play span").addClass("glyphicon-play"),window.controllerPlayer.sendPause())},displayInfo:function(a){clearInterval(g);var b="play"==a.status.state,c=a.playlist>a.status.song?a.status.song:0;if(this.model=new d.PlayerInfo({artist:a.playlist[c].artist,title:null!=a.playlist[c].name&&a.playlist[c].name.length>0?a.playlist[c].name:a.playlist[c].title,pos:a.playlist[c].pos,album:a.playlist[c].album,ellapsed_time:f.UtilTime.timeToStr(a.status.elapsed),ellapsed_time_int:a.status.elapsed,total_time:f.UtilTime.timeToStr(a.playlist[c].time),total_time_int:parseInt(a.playlist[c].time),pct:100*a.status.elapsed/a.playlist[c].time,play:b}),this.render(),b){var e=this.model,h=this;g=setInterval(function(){parseInt(e.get("pct"))>=100&&window.controllerPlayer.sendStatus();var a=parseInt(e.get("ellapsed_time_int"))+1;e.set({ellapsed_time_int:a}),e.set({ellapsed_time:f.UtilTime.timeToStr(a)}),e.set({pct:100*a/e.get("total_time_int")}),h.render()},1e3)}}})});